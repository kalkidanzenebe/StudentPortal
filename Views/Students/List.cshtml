@using StudentPortal.Web.Models.Entities
@model List<StudentPortal.Web.Models.Entities.Student>
@if (TempData["SuccessMessage"] != null)
{
    var messageType = TempData["MessageType"] as string;
    var alertClass = messageType == "delete" ? "alert-danger" : "alert-success"; // Determine class based on message type
    <div id="successMessage" class="alert @alertClass">
        <!-- Use alert class based on message type -->
        @TempData["SuccessMessage"]
    </div>
}

<script>
    window.onload = function() {
        var successMessage = document.getElementById("successMessage");
        if (successMessage) {
            setTimeout(function() {
                successMessage.style.display = 'none';
            }, 3000); // Message disappears after 3 seconds
        }

        // Scroll to the highlighted student if applicable
        var highlightId = '@ViewBag.HighlightId';
        if (highlightId) {
            var highlightedRow = document.getElementById('student-' + highlightId);
            if (highlightedRow) {
                highlightedRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
    };
</script>


<h1>Students</h1>

<a class="btn btn-success mb-3" href="@Url.Action("Add", "Students")">Add New Student</a>

<table class="table">
    <thead>
        <tr>
            <th>Id</th>
            <th>Name</th>
            <th>Email</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var student in Model)
        {
            var highlightClass = student.Id == ViewBag.HighlightId ? "table-success" : ""; // Change class if highlighted
            <tr id="student-@student.Id" class="@highlightClass">
                <td>@student.Id</td>
                <td>@student.Name</td>
                <td>@student.Email</td>
                <td>
                    <a class="btn btn-primary" asp-controller="Students" asp-action="Edit" asp-route-id="@student.Id">Edit</a>
                    <form method="post" action="@Url.Action("Delete", "Students")" style="display:inline;">
                        <input type="hidden" name="id" value="@student.Id" />
                        <button type="submit" class="btn btn-danger">Delete</button>
                    </form>
                </td>
            </tr>
        }
    </tbody>
</table>
